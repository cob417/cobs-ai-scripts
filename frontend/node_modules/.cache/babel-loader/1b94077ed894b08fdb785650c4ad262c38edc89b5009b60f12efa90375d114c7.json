{"ast":null,"code":"/**\n * Custom hook for managing jobs\n */import{useState,useEffect,useCallback,useRef}from'react';import{getJobs,createJob,updateJob,deleteJob,runJob}from'../services/api';import{useErrorHandler}from'./useErrorHandler';export const useJobs=()=>{const[jobs,setJobs]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const handleError=useErrorHandler();const isInitialLoadRef=useRef(true);const loadJobs=useCallback(async()=>{try{// Only set loading on initial load, not on manual refreshes\n// This prevents the UI from unmounting/remounting and resetting scroll position\nif(isInitialLoadRef.current){setLoading(true);}setError(null);const data=await getJobs();setJobs(data);}catch(err){const errorMessage=handleError(err);setError(errorMessage);}finally{setLoading(false);isInitialLoadRef.current=false;}},[handleError]);useEffect(()=>{loadJobs();},[loadJobs]);const create=useCallback(async jobData=>{try{const newJob=await createJob(jobData);setJobs(prev=>[...prev,newJob]);return newJob;}catch(err){handleError(err);throw err;}},[handleError]);const update=useCallback(async(id,jobData)=>{try{const updatedJob=await updateJob(id,jobData);setJobs(prev=>prev.map(job=>job.id===id?updatedJob:job));return updatedJob;}catch(err){handleError(err);throw err;}},[handleError]);const remove=useCallback(async id=>{try{await deleteJob(id);setJobs(prev=>prev.filter(job=>job.id!==id));}catch(err){handleError(err);throw err;}},[handleError]);const run=useCallback(async id=>{try{await runJob(id);}catch(err){handleError(err);throw err;}},[handleError]);return{jobs,loading,error,loadJobs,create,update,remove,run};};","map":{"version":3,"names":["useState","useEffect","useCallback","useRef","getJobs","createJob","updateJob","deleteJob","runJob","useErrorHandler","useJobs","jobs","setJobs","loading","setLoading","error","setError","handleError","isInitialLoadRef","loadJobs","current","data","err","errorMessage","create","jobData","newJob","prev","update","id","updatedJob","map","job","remove","filter","run"],"sources":["/home/cob417/github/cob-ai-scripts/frontend/src/hooks/useJobs.ts"],"sourcesContent":["/**\n * Custom hook for managing jobs\n */\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { Job, JobCreate, JobUpdate, getJobs, createJob, updateJob, deleteJob, runJob } from '../services/api';\nimport { useErrorHandler } from './useErrorHandler';\n\nexport const useJobs = () => {\n  const [jobs, setJobs] = useState<Job[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const handleError = useErrorHandler();\n  const isInitialLoadRef = useRef(true);\n\n  const loadJobs = useCallback(async () => {\n    try {\n      // Only set loading on initial load, not on manual refreshes\n      // This prevents the UI from unmounting/remounting and resetting scroll position\n      if (isInitialLoadRef.current) {\n        setLoading(true);\n      }\n      setError(null);\n      const data = await getJobs();\n      setJobs(data);\n    } catch (err) {\n      const errorMessage = handleError(err);\n      setError(errorMessage);\n    } finally {\n      setLoading(false);\n      isInitialLoadRef.current = false;\n    }\n  }, [handleError]);\n\n  useEffect(() => {\n    loadJobs();\n  }, [loadJobs]);\n\n  const create = useCallback(async (jobData: JobCreate) => {\n    try {\n      const newJob = await createJob(jobData);\n      setJobs((prev) => [...prev, newJob]);\n      return newJob;\n    } catch (err) {\n      handleError(err);\n      throw err;\n    }\n  }, [handleError]);\n\n  const update = useCallback(async (id: number, jobData: JobUpdate) => {\n    try {\n      const updatedJob = await updateJob(id, jobData);\n      setJobs((prev) => prev.map((job) => (job.id === id ? updatedJob : job)));\n      return updatedJob;\n    } catch (err) {\n      handleError(err);\n      throw err;\n    }\n  }, [handleError]);\n\n  const remove = useCallback(async (id: number) => {\n    try {\n      await deleteJob(id);\n      setJobs((prev) => prev.filter((job) => job.id !== id));\n    } catch (err) {\n      handleError(err);\n      throw err;\n    }\n  }, [handleError]);\n\n  const run = useCallback(async (id: number) => {\n    try {\n      await runJob(id);\n    } catch (err) {\n      handleError(err);\n      throw err;\n    }\n  }, [handleError]);\n\n  return {\n    jobs,\n    loading,\n    error,\n    loadJobs,\n    create,\n    update,\n    remove,\n    run,\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
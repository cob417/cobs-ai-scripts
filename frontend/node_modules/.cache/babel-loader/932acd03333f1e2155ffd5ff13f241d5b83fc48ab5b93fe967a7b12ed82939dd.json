{"ast":null,"code":"/**\n * Custom hook for managing job runs\n */import{useState,useEffect,useCallback,useRef}from'react';import{getJobRuns,getJobRun}from'../services/api';import{useErrorHandler}from'./useErrorHandler';export const useJobRuns=function(){let limit=arguments.length>0&&arguments[0]!==undefined?arguments[0]:50;const[runs,setRuns]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const handleError=useErrorHandler();const isInitialLoadRef=useRef(true);const loadRuns=useCallback(async()=>{try{// Only set loading on initial load, not on polling refreshes\n// This prevents the UI from unmounting/remounting and resetting scroll position\nif(isInitialLoadRef.current){setLoading(true);}setError(null);const data=await getJobRuns(limit);setRuns(data);}catch(err){const errorMessage=handleError(err);setError(errorMessage);}finally{setLoading(false);isInitialLoadRef.current=false;}},[limit,handleError]);useEffect(()=>{loadRuns();const interval=setInterval(loadRuns,10000);// Refresh every 10 seconds\nreturn()=>clearInterval(interval);},[loadRuns]);const getRun=useCallback(async id=>{try{return await getJobRun(id);}catch(err){handleError(err);throw err;}},[handleError]);return{runs,loading,error,loadRuns,getRun};};","map":{"version":3,"names":["useState","useEffect","useCallback","useRef","getJobRuns","getJobRun","useErrorHandler","useJobRuns","limit","arguments","length","undefined","runs","setRuns","loading","setLoading","error","setError","handleError","isInitialLoadRef","loadRuns","current","data","err","errorMessage","interval","setInterval","clearInterval","getRun","id"],"sources":["/home/cob417/github/cob-ai-scripts/frontend/src/hooks/useJobRuns.ts"],"sourcesContent":["/**\n * Custom hook for managing job runs\n */\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { JobRun, getJobRuns, getJobRun } from '../services/api';\nimport { useErrorHandler } from './useErrorHandler';\n\nexport const useJobRuns = (limit: number = 50) => {\n  const [runs, setRuns] = useState<JobRun[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const handleError = useErrorHandler();\n  const isInitialLoadRef = useRef(true);\n\n  const loadRuns = useCallback(async () => {\n    try {\n      // Only set loading on initial load, not on polling refreshes\n      // This prevents the UI from unmounting/remounting and resetting scroll position\n      if (isInitialLoadRef.current) {\n        setLoading(true);\n      }\n      setError(null);\n      const data = await getJobRuns(limit);\n      setRuns(data);\n    } catch (err) {\n      const errorMessage = handleError(err);\n      setError(errorMessage);\n    } finally {\n      setLoading(false);\n      isInitialLoadRef.current = false;\n    }\n  }, [limit, handleError]);\n\n  useEffect(() => {\n    loadRuns();\n    const interval = setInterval(loadRuns, 10000); // Refresh every 10 seconds\n    return () => clearInterval(interval);\n  }, [loadRuns]);\n\n  const getRun = useCallback(async (id: number): Promise<JobRun> => {\n    try {\n      return await getJobRun(id);\n    } catch (err) {\n      handleError(err);\n      throw err;\n    }\n  }, [handleError]);\n\n  return {\n    runs,\n    loading,\n    error,\n    loadRuns,\n    getRun,\n  };\n};\n"],"mappings":"AAAA;AACA;AACA,GAEA,OAASA,QAAQ,CAAEC,SAAS,CAAEC,WAAW,CAAEC,MAAM,KAAQ,OAAO,CAChE,OAAiBC,UAAU,CAAEC,SAAS,KAAQ,iBAAiB,CAC/D,OAASC,eAAe,KAAQ,mBAAmB,CAEnD,MAAO,MAAM,CAAAC,UAAU,CAAG,QAAAA,CAAA,CAAwB,IAAvB,CAAAC,KAAa,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,EAAE,CAC3C,KAAM,CAACG,IAAI,CAAEC,OAAO,CAAC,CAAGb,QAAQ,CAAW,EAAE,CAAC,CAC9C,KAAM,CAACc,OAAO,CAAEC,UAAU,CAAC,CAAGf,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACgB,KAAK,CAAEC,QAAQ,CAAC,CAAGjB,QAAQ,CAAgB,IAAI,CAAC,CACvD,KAAM,CAAAkB,WAAW,CAAGZ,eAAe,CAAC,CAAC,CACrC,KAAM,CAAAa,gBAAgB,CAAGhB,MAAM,CAAC,IAAI,CAAC,CAErC,KAAM,CAAAiB,QAAQ,CAAGlB,WAAW,CAAC,SAAY,CACvC,GAAI,CACF;AACA;AACA,GAAIiB,gBAAgB,CAACE,OAAO,CAAE,CAC5BN,UAAU,CAAC,IAAI,CAAC,CAClB,CACAE,QAAQ,CAAC,IAAI,CAAC,CACd,KAAM,CAAAK,IAAI,CAAG,KAAM,CAAAlB,UAAU,CAACI,KAAK,CAAC,CACpCK,OAAO,CAACS,IAAI,CAAC,CACf,CAAE,MAAOC,GAAG,CAAE,CACZ,KAAM,CAAAC,YAAY,CAAGN,WAAW,CAACK,GAAG,CAAC,CACrCN,QAAQ,CAACO,YAAY,CAAC,CACxB,CAAC,OAAS,CACRT,UAAU,CAAC,KAAK,CAAC,CACjBI,gBAAgB,CAACE,OAAO,CAAG,KAAK,CAClC,CACF,CAAC,CAAE,CAACb,KAAK,CAAEU,WAAW,CAAC,CAAC,CAExBjB,SAAS,CAAC,IAAM,CACdmB,QAAQ,CAAC,CAAC,CACV,KAAM,CAAAK,QAAQ,CAAGC,WAAW,CAACN,QAAQ,CAAE,KAAK,CAAC,CAAE;AAC/C,MAAO,IAAMO,aAAa,CAACF,QAAQ,CAAC,CACtC,CAAC,CAAE,CAACL,QAAQ,CAAC,CAAC,CAEd,KAAM,CAAAQ,MAAM,CAAG1B,WAAW,CAAC,KAAO,CAAA2B,EAAU,EAAsB,CAChE,GAAI,CACF,MAAO,MAAM,CAAAxB,SAAS,CAACwB,EAAE,CAAC,CAC5B,CAAE,MAAON,GAAG,CAAE,CACZL,WAAW,CAACK,GAAG,CAAC,CAChB,KAAM,CAAAA,GAAG,CACX,CACF,CAAC,CAAE,CAACL,WAAW,CAAC,CAAC,CAEjB,MAAO,CACLN,IAAI,CACJE,OAAO,CACPE,KAAK,CACLI,QAAQ,CACRQ,MACF,CAAC,CACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}